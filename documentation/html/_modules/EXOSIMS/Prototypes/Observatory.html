<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>EXOSIMS.Prototypes.Observatory &#8212; EXOSIMS 1.1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for EXOSIMS.Prototypes.Observatory</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">import</span> <span class="nn">astropy.constants</span> <span class="k">as</span> <span class="nn">const</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="k">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">EXOSIMS.util.eccanom</span> <span class="k">import</span> <span class="n">eccanom</span>

<div class="viewcode-block" id="Observatory"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory">[docs]</a><span class="k">class</span> <span class="nc">Observatory</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Observatory class template</span>
<span class="sd">    </span>
<span class="sd">    This class contains all variables and methods necessary to perform</span>
<span class="sd">    Observatory Definition Module calculations in exoplanet mission simulation.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        \*\*specs: </span>
<span class="sd">            user specified values</span>
<span class="sd">        forceStaticEphem (bool):</span>
<span class="sd">            If True, forces use of stored ephemerides for solar system objects</span>
<span class="sd">            and uses eccanom utility to propagate.  Defaults to False.</span>
<span class="sd">        spkpath (str):</span>
<span class="sd">            Path to SPK file on disk (Defaults to de432s.bsp). </span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        settlingTime (astropy Quantity): </span>
<span class="sd">            Instrument settling time after repoint in units of day</span>
<span class="sd">        thrust (astropy Quantity): </span>
<span class="sd">            Occulter slew thrust in units of mN</span>
<span class="sd">        slewIsp (astropy Quantity): </span>
<span class="sd">            Occulter slew specific impulse in units of s</span>
<span class="sd">        scMass (astropy Quantity): </span>
<span class="sd">            Occulter (maneuvering sc) wet mass in units of kg</span>
<span class="sd">        dryMass (astropy Quantity): </span>
<span class="sd">            Occulter (maneuvering sc) dry mass in units of kg</span>
<span class="sd">        coMass (astropy Quantity): </span>
<span class="sd">            Telescope (non-maneuvering sc) mass in units of kg</span>
<span class="sd">        occulterSep (astropy Quantity): </span>
<span class="sd">            Occulter-telescope distance in units of km</span>
<span class="sd">        skIsp (astropy Quantity): </span>
<span class="sd">            Station-keeping specific impulse in units of s</span>
<span class="sd">        defburnPortion (float):</span>
<span class="sd">            Default burn portion</span>
<span class="sd">        flowRate (astropy Quantity): </span>
<span class="sd">            Slew flow rate in units of kg/day</span>
<span class="sd">    </span>
<span class="sd">    Notes:</span>
<span class="sd">        For finding positions of solar system bodies, this routine will attempt to </span>
<span class="sd">        use the jplephem module and a local SPK file on disk.  The module can be </span>
<span class="sd">        installed via pip or from source.  The default SPK file can be downloaded from</span>
<span class="sd">        here: http://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/planets/de430.bsp</span>
<span class="sd">        and should be placed in the Observatory subdirectory of EXOSIMS.</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_modtype</span> <span class="o">=</span> <span class="s1">&#39;Observatory&#39;</span>
    <span class="n">_outspec</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settlingTime</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">thrust</span><span class="o">=</span><span class="mf">450.</span><span class="p">,</span> <span class="n">slewIsp</span><span class="o">=</span><span class="mf">4160.</span><span class="p">,</span> <span class="n">scMass</span><span class="o">=</span><span class="mf">6000.</span><span class="p">,</span>\
                 <span class="n">dryMass</span><span class="o">=</span><span class="mf">3400.</span><span class="p">,</span> <span class="n">coMass</span><span class="o">=</span><span class="mf">5800.</span><span class="p">,</span> <span class="n">occulterSep</span><span class="o">=</span><span class="mf">55000.</span><span class="p">,</span> <span class="n">skIsp</span><span class="o">=</span><span class="mf">220.</span><span class="p">,</span>\
                 <span class="n">defburnPortion</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">spkpath</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">forceStaticEphem</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>\
                 <span class="o">**</span><span class="n">specs</span><span class="p">):</span>
        
        <span class="c1"># default Observatory values</span>
        <span class="c1"># instrument settling time after repoint (days)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settlingTime</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">settlingTime</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">day</span> 
        <span class="c1"># occulter slew thrust (mN)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thrust</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">thrust</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">mN</span> 
        <span class="c1"># occulter slew specific impulse (s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slewIsp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">slewIsp</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span> 
        <span class="c1"># occulter (maneuvering sc) initial (wet) mass (kg)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scMass</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">scMass</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span> 
        <span class="c1"># occulter (maneuvering sc) dry mass (kg)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dryMass</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dryMass</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span> 
        <span class="c1"># telescope (or non-maneuvering sc) mass (kg)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coMass</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">coMass</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span> 
        <span class="c1"># occulter-telescope distance (km)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occulterSep</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">occulterSep</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        <span class="c1"># station-keeping Isp (s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skIsp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">skIsp</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span> 
        <span class="c1"># default burn portion</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defburnPortion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">defburnPortion</span><span class="p">)</span>
        
        <span class="c1"># set values derived from quantities above</span>
        <span class="c1"># slew flow rate (kg/day)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flowRate</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thrust</span><span class="o">/</span><span class="n">const</span><span class="o">.</span><span class="n">g0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">slewIsp</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kg/day&#39;</span><span class="p">)</span>
        
        <span class="c1">#if jplephem is available, we&#39;ll use that for propagating solar system bodies</span>
        <span class="c1">#otherwise, use static ephemeris</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">forceStaticEphem</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">jplephem.spk</span> <span class="k">import</span> <span class="n">SPK</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">havejplephem</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="nb">print</span> <span class="s2">&quot;WARNING: Module jplephem not found, using static solar system ephemeris.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">havejplephem</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">havejplephem</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span> <span class="s2">&quot;Using static solar system ephemeris.&quot;</span>
        
        <span class="c1"># populate outspec</span>
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">att</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outspec</span><span class="p">[</span><span class="n">att</span><span class="p">]</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span><span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)</span> <span class="k">else</span> <span class="n">dat</span>
        
        <span class="c1"># define function for calculating obliquity of the ecliptic </span>
        <span class="c1"># (arg Julian centuries from J2000)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">TDB</span><span class="p">:</span> <span class="mf">23.439279</span> <span class="o">-</span> <span class="mf">0.0130102</span><span class="o">*</span><span class="n">TDB</span> <span class="o">-</span> <span class="mf">5.086e-8</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> \
                <span class="mf">5.565e-7</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.6e-10</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.21e-11</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span> 
        
        <span class="c1"># if you have jplephem, load spice file, otherwise load static ephem</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">havejplephem</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">spkpath</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">spkpath</span><span class="p">)):</span>
                <span class="c1"># if the path does not exist, load the default de432s.bsp</span>
                    <span class="n">classpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">classpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classpath</span><span class="p">,</span><span class="s1">&#39;..&#39;</span><span class="p">,</span><span class="s1">&#39;Observatory&#39;</span><span class="p">))</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;de432s.bsp&#39;</span>
                    <span class="n">spkpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classpath</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">SPK</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">spkpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;All ephemeride data from Vallado Appendix D.4</span>
<span class="sd">            Values are:</span>
<span class="sd">            a     e             I               O                       w                   lM</span>
<span class="sd">            sma   eccentricity  inclination     long. ascending node    long. perihelion    mean longitude</span>
<span class="sd">            AU    N/A           deg             deg                     deg                 deg</span>
<span class="sd">            &quot;&quot;&quot;</span>
            
            <span class="c1"># Store Mercury ephemerides data (ecliptic)</span>
            <span class="n">Mercurya</span> <span class="o">=</span> <span class="mf">0.387098310</span>
            <span class="n">Mercurye</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.20563175</span><span class="p">,</span> <span class="mf">0.000020406</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000000284</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000000017</span><span class="p">]</span>
            <span class="n">Mercuryi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.004986</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0059516</span><span class="p">,</span> <span class="mf">0.00000081</span><span class="p">,</span> <span class="mf">0.000000041</span><span class="p">]</span>
            <span class="n">MercuryO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">48.330893</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1254229</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00008833</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000196</span><span class="p">]</span>
            <span class="n">Mercuryw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">77.456119</span><span class="p">,</span> <span class="mf">0.1588643</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00001343</span><span class="p">,</span> <span class="mf">0.000000039</span><span class="p">]</span>
            <span class="n">MercurylM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">252.250906</span><span class="p">,</span> <span class="mf">149472.6746358</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000535</span><span class="p">,</span> <span class="mf">0.000000002</span><span class="p">]</span>
            <span class="n">Mercury</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Mercurya</span><span class="p">,</span> <span class="n">Mercurye</span><span class="p">,</span> <span class="n">Mercuryi</span><span class="p">,</span> <span class="n">MercuryO</span><span class="p">,</span> <span class="n">Mercuryw</span><span class="p">,</span> <span class="n">MercurylM</span><span class="p">)</span>
            
            <span class="c1"># Store Venus epemerides data (ecliptic)</span>
            <span class="n">Venusa</span> <span class="o">=</span> <span class="mf">0.723329820</span>
            <span class="n">Venuse</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.00677188</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000047766</span><span class="p">,</span> <span class="mf">0.0000000975</span><span class="p">,</span> <span class="mf">0.00000000044</span><span class="p">]</span>
            <span class="n">Venusi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.394662</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0008568</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00003244</span><span class="p">,</span> <span class="mf">0.000000010</span><span class="p">]</span>
            <span class="n">VenusO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">76.679920</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2780080</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00014256</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000198</span><span class="p">]</span>
            <span class="n">Venusw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">131.563707</span><span class="p">,</span> <span class="mf">0.0048646</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00138232</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000005332</span><span class="p">]</span>
            <span class="n">VenuslM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">181.979801</span><span class="p">,</span> <span class="mf">58517.8156760</span><span class="p">,</span> <span class="mf">0.00000165</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000002</span><span class="p">]</span>
            <span class="n">Venus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Venusa</span><span class="p">,</span> <span class="n">Venuse</span><span class="p">,</span> <span class="n">Venusi</span><span class="p">,</span> <span class="n">VenusO</span><span class="p">,</span> <span class="n">Venusw</span><span class="p">,</span> <span class="n">VenuslM</span><span class="p">)</span>
            
            <span class="c1"># Store Earth ephemerides data (ecliptic)</span>
            <span class="n">Eartha</span> <span class="o">=</span> <span class="mf">1.000001018</span>
            <span class="n">Earthe</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01670862</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000042037</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000001236</span><span class="p">,</span> <span class="mf">0.00000000004</span><span class="p">]</span>
            <span class="n">Earthi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.0130546</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000931</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000034</span><span class="p">]</span>
            <span class="n">EarthO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">174.873174</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2410908</span><span class="p">,</span> <span class="mf">0.00004067</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000001327</span><span class="p">]</span>
            <span class="n">Earthw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">102.937348</span><span class="p">,</span> <span class="mf">0.3225557</span><span class="p">,</span> <span class="mf">0.00015026</span><span class="p">,</span> <span class="mf">0.000000478</span><span class="p">]</span>
            <span class="n">EarthlM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">100.466449</span><span class="p">,</span> <span class="mf">35999.3728519</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000568</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
            <span class="n">Earth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Eartha</span><span class="p">,</span> <span class="n">Earthe</span><span class="p">,</span> <span class="n">Earthi</span><span class="p">,</span> <span class="n">EarthO</span><span class="p">,</span> <span class="n">Earthw</span><span class="p">,</span> <span class="n">EarthlM</span><span class="p">)</span>
            
            <span class="c1"># Store Mars ephemerides data (ecliptic)</span>
            <span class="n">Marsa</span> <span class="o">=</span> <span class="mf">1.523679342</span>
            <span class="n">Marse</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.09340062</span><span class="p">,</span> <span class="mf">0.000090483</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000000806</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000000035</span><span class="p">]</span>
            <span class="n">Marsi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.849726</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0081479</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00002255</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000027</span><span class="p">]</span>
            <span class="n">MarsO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">49.558093</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2949846</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00063993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000002143</span><span class="p">]</span>
            <span class="n">Marsw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">336.060234</span><span class="p">,</span> <span class="mf">0.4438898</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00017321</span><span class="p">,</span> <span class="mf">0.000000300</span><span class="p">]</span>
            <span class="n">MarslM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">355.433275</span><span class="p">,</span> <span class="mf">19140.2993313</span><span class="p">,</span> <span class="mf">0.00000261</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000003</span><span class="p">]</span>
            <span class="n">Mars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Marsa</span><span class="p">,</span> <span class="n">Marse</span><span class="p">,</span> <span class="n">Marsi</span><span class="p">,</span> <span class="n">MarsO</span><span class="p">,</span> <span class="n">Marsw</span><span class="p">,</span> <span class="n">MarslM</span><span class="p">)</span>
            
            <span class="c1"># Store Jupiter ephemerides data (ecliptic)</span>
            <span class="n">Jupitera</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.202603191</span><span class="p">,</span> <span class="mf">0.0000001913</span><span class="p">]</span>
            <span class="n">Jupitere</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04849485</span><span class="p">,</span> <span class="mf">0.000163244</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000004719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000000197</span><span class="p">]</span>
            <span class="n">Jupiteri</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.303270</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0019872</span><span class="p">,</span> <span class="mf">0.00003318</span><span class="p">,</span> <span class="mf">0.000000092</span><span class="p">]</span>
            <span class="n">JupiterO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">100.464441</span><span class="p">,</span> <span class="mf">0.1766828</span><span class="p">,</span> <span class="mf">0.00090387</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000007032</span><span class="p">]</span>
            <span class="n">Jupiterw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">14.331309</span><span class="p">,</span> <span class="mf">0.2155525</span><span class="p">,</span> <span class="mf">0.00072252</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000004590</span><span class="p">]</span>
            <span class="n">JupiterlM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">34.351484</span><span class="p">,</span> <span class="mf">3034.9056746</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00008501</span><span class="p">,</span> <span class="mf">0.000000004</span><span class="p">]</span>
            <span class="n">Jupiter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Jupitera</span><span class="p">,</span> <span class="n">Jupitere</span><span class="p">,</span> <span class="n">Jupiteri</span><span class="p">,</span> <span class="n">JupiterO</span><span class="p">,</span> <span class="n">Jupiterw</span><span class="p">,</span> <span class="n">JupiterlM</span><span class="p">)</span>
            
            <span class="c1"># Store Saturn ephemerides data (ecliptic)</span>
            <span class="n">Saturna</span> <span class="o">=</span> <span class="p">[</span><span class="mf">9.554909596</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000021389</span><span class="p">]</span>
            <span class="n">Saturne</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05550862</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000346818</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000006456</span><span class="p">,</span> <span class="mf">0.00000000338</span><span class="p">]</span>
            <span class="n">Saturni</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.488878</span><span class="p">,</span> <span class="mf">0.0025515</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00004903</span><span class="p">,</span> <span class="mf">0.000000018</span><span class="p">]</span>
            <span class="n">SaturnO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">113.665524</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2566649</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00018345</span><span class="p">,</span> <span class="mf">0.000000357</span><span class="p">]</span>
            <span class="n">Saturnw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">93.056787</span><span class="p">,</span> <span class="mf">0.5665496</span><span class="p">,</span> <span class="mf">0.00052809</span><span class="p">,</span> <span class="mf">0.000004882</span><span class="p">]</span>
            <span class="n">SaturnlM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">50.077471</span><span class="p">,</span> <span class="mf">1222.1137943</span><span class="p">,</span> <span class="mf">0.00021004</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000019</span><span class="p">]</span>
            <span class="n">Saturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Saturna</span><span class="p">,</span> <span class="n">Saturne</span><span class="p">,</span> <span class="n">Saturni</span><span class="p">,</span> <span class="n">SaturnO</span><span class="p">,</span> <span class="n">Saturnw</span><span class="p">,</span> <span class="n">SaturnlM</span><span class="p">)</span>
            
            <span class="c1"># Store Uranus ephemerides data (ecliptic)</span>
            <span class="n">Uranusa</span> <span class="o">=</span> <span class="p">[</span><span class="mf">19.218446062</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000000372</span><span class="p">,</span> <span class="mf">0.00000000098</span><span class="p">]</span>
            <span class="n">Uranuse</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04629590</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000027337</span><span class="p">,</span> <span class="mf">0.0000000790</span><span class="p">,</span> <span class="mf">0.00000000025</span><span class="p">]</span>
            <span class="n">Uranusi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.773196</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0016869</span><span class="p">,</span> <span class="mf">0.00000349</span><span class="p">,</span> <span class="mf">0.000000016</span><span class="p">]</span>
            <span class="n">UranusO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">74.005947</span><span class="p">,</span> <span class="mf">0.0741461</span><span class="p">,</span> <span class="mf">0.00040540</span><span class="p">,</span> <span class="mf">0.000000104</span><span class="p">]</span>
            <span class="n">Uranusw</span> <span class="o">=</span> <span class="p">[</span><span class="mf">173.005159</span><span class="p">,</span> <span class="mf">0.0893206</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00009470</span><span class="p">,</span> <span class="mf">0.000000413</span><span class="p">]</span>
            <span class="n">UranuslM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">314.055005</span><span class="p">,</span> <span class="mf">428.4669983</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000486</span><span class="p">,</span> <span class="mf">0.000000006</span><span class="p">]</span>
            <span class="n">Uranus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Uranusa</span><span class="p">,</span> <span class="n">Uranuse</span><span class="p">,</span> <span class="n">Uranusi</span><span class="p">,</span> <span class="n">UranusO</span><span class="p">,</span> <span class="n">Uranusw</span><span class="p">,</span> <span class="n">UranuslM</span><span class="p">)</span>
            
            <span class="c1"># Store Neptune ephemerides data (ecliptic)</span>
            <span class="n">Neptunea</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.110386869</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000001663</span><span class="p">,</span> <span class="mf">0.00000000069</span><span class="p">]</span>
            <span class="n">Neptunee</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.00898809</span><span class="p">,</span> <span class="mf">0.000006408</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0000000008</span><span class="p">]</span>
            <span class="n">Neptunei</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.769952</span><span class="p">,</span> <span class="mf">0.0002257</span><span class="p">,</span> <span class="mf">0.00000023</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000000</span><span class="p">]</span>
            <span class="n">NeptuneO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">131.784057</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0061651</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00000219</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000078</span><span class="p">]</span>
            <span class="n">Neptunew</span> <span class="o">=</span> <span class="p">[</span><span class="mf">48.123691</span><span class="p">,</span> <span class="mf">0.0291587</span><span class="p">,</span> <span class="mf">0.00007051</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]</span>
            <span class="n">NeptunelM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">304.348665</span><span class="p">,</span> <span class="mf">218.4862002</span><span class="p">,</span> <span class="mf">0.00000059</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000000002</span><span class="p">]</span>
            <span class="n">Neptune</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Neptunea</span><span class="p">,</span> <span class="n">Neptunee</span><span class="p">,</span> <span class="n">Neptunei</span><span class="p">,</span> <span class="n">NeptuneO</span><span class="p">,</span> <span class="n">Neptunew</span><span class="p">,</span> <span class="n">NeptunelM</span><span class="p">)</span>
            
            <span class="c1"># Store Pluto ephemerides data (ecliptic)</span>
            <span class="n">Plutoa</span> <span class="o">=</span> <span class="p">[</span><span class="mf">39.48168677</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.00076912</span><span class="p">]</span>
            <span class="n">Plutoe</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.24880766</span><span class="p">,</span> <span class="mf">0.00006465</span><span class="p">]</span>
            <span class="n">Plutoi</span> <span class="o">=</span> <span class="p">[</span><span class="mf">17.14175</span><span class="p">,</span> <span class="mf">0.003075</span><span class="p">]</span>
            <span class="n">PlutoO</span> <span class="o">=</span> <span class="p">[</span><span class="mf">110.30347</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01036944</span><span class="p">]</span>
            <span class="n">Plutow</span> <span class="o">=</span> <span class="p">[</span><span class="mf">224.06676</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03673611</span><span class="p">]</span>
            <span class="n">PlutolM</span> <span class="o">=</span> <span class="p">[</span><span class="mf">238.92881</span><span class="p">,</span> <span class="mf">145.2078</span><span class="p">]</span>
            <span class="n">Pluto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SolarEph</span><span class="p">(</span><span class="n">Plutoa</span><span class="p">,</span> <span class="n">Plutoe</span><span class="p">,</span> <span class="n">Plutoi</span><span class="p">,</span> <span class="n">PlutoO</span><span class="p">,</span> <span class="n">Plutow</span><span class="p">,</span> <span class="n">PlutolM</span><span class="p">)</span>
            
            <span class="c1">#store all as dictionary:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">planets</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mercury&#39;</span><span class="p">:</span> <span class="n">Mercury</span><span class="p">,</span>
                            <span class="s1">&#39;Venus&#39;</span><span class="p">:</span> <span class="n">Venus</span><span class="p">,</span>
                            <span class="s1">&#39;Earth&#39;</span><span class="p">:</span> <span class="n">Earth</span><span class="p">,</span>
                            <span class="s1">&#39;Mars&#39;</span><span class="p">:</span> <span class="n">Mars</span><span class="p">,</span>
                            <span class="s1">&#39;Jupiter&#39;</span><span class="p">:</span> <span class="n">Jupiter</span><span class="p">,</span>
                            <span class="s1">&#39;Saturn&#39;</span><span class="p">:</span> <span class="n">Saturn</span><span class="p">,</span>
                            <span class="s1">&#39;Uranus&#39;</span><span class="p">:</span> <span class="n">Uranus</span><span class="p">,</span>
                            <span class="s1">&#39;Neptune&#39;</span><span class="p">:</span> <span class="n">Neptune</span><span class="p">,</span>
                            <span class="s1">&#39;Pluto&#39;</span><span class="p">:</span> <span class="n">Pluto</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;String representation of the Observatory object</span>
<span class="sd">        </span>
<span class="sd">        When the command &#39;print&#39; is used on the Observatory object, this method</span>
<span class="sd">        will print the attribute values contained in the object&quot;&quot;&quot;</span>
        
        <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">att</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="s1">&#39;Observatory class object attributes&#39;</span>

<div class="viewcode-block" id="Observatory.orbit"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.orbit">[docs]</a>    <span class="k">def</span> <span class="nf">orbit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds observatory orbit position vector in heliocentric equatorial frame.</span>
<span class="sd">        </span>
<span class="sd">        This method defines the data type expected, orbits are determined by specific</span>
<span class="sd">        instances of Observatory classes.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time array):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_sc (astropy Quantity nx3 array):</span>
<span class="sd">                Observatory (spacecraft) position vector in units of km</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">r_sc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">mjd</span><span class="p">),(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">mjd</span><span class="p">),(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">mjd</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">r_sc</span><span class="p">)),</span> <span class="s1">&#39;Observatory position vector r_sc has infinite value.&#39;</span>
        
        <span class="k">return</span> <span class="n">r_sc</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.keepout"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.keepout">[docs]</a>    <span class="k">def</span> <span class="nf">keepout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TL</span><span class="p">,</span> <span class="n">sInds</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">,</span> <span class="n">r_sc</span><span class="p">,</span> <span class="n">koangle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds keepout Boolean values for stars of interest.</span>
<span class="sd">        </span>
<span class="sd">        This method defines the data type expected, all values are True.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            TL (TargetList module):</span>
<span class="sd">                TargetList class object</span>
<span class="sd">            sInds (integer ndarray):</span>
<span class="sd">                Integer indices of the stars of interest</span>
<span class="sd">            currentTime (astropy Time array):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">            r_sc (astropy Quantity nx3 array):</span>
<span class="sd">                Current observatory (spacecraft) position vector in units of km</span>
<span class="sd">            koangle (astropy Quantity):</span>
<span class="sd">                Telescope keepout angle in units of degree</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            kogood (boolean ndarray):</span>
<span class="sd">                True is a target unobstructed and observable, and False is a </span>
<span class="sd">                target unobservable due to obstructions in the keepout zone.</span>
<span class="sd">        </span>
<span class="sd">        Note: currentTime and r_sc must be of same size.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape sInds</span>
        <span class="n">sInds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sInds</span><span class="p">,</span><span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="c1"># check size of currentTime and r_sc</span>
        <span class="k">assert</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">r_sc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;currentTime and r_sc must be of same size.&#39;</span>
        
        <span class="n">kogood</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        
        <span class="c1"># check to make sure all elements in self.kogood are Boolean</span>
        <span class="n">trues</span> <span class="o">=</span> <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">kogood</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">trues</span><span class="p">),</span> <span class="s1">&#39;An element of kogood is not Boolean&#39;</span>
        
        <span class="k">return</span> <span class="n">kogood</span></div>

<div class="viewcode-block" id="Observatory.solarSystem_body_position"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.solarSystem_body_position">[docs]</a>    <span class="k">def</span> <span class="nf">solarSystem_body_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">,</span> <span class="n">bodyname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds position vector for solar system objects</span>
<span class="sd">        </span>
<span class="sd">        This passes all arguments to one of spk_body or keplerplanet, depending</span>
<span class="sd">        on the value of self.havejplephem.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">            bodyname (string):</span>
<span class="sd">                Solar system object name</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_body (astropy Quantity nx3 array):</span>
<span class="sd">                Heliocentric equatorial position vector in units of km</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">havejplephem</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spk_body</span><span class="p">(</span><span class="n">currentTime</span><span class="p">,</span> <span class="n">bodyname</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keplerplanet</span><span class="p">(</span><span class="n">currentTime</span><span class="p">,</span> <span class="n">bodyname</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">r_body</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.spk_body"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.spk_body">[docs]</a>    <span class="k">def</span> <span class="nf">spk_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">,</span> <span class="n">bodyname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds position vector for solar system objects</span>
<span class="sd">        </span>
<span class="sd">        This method uses spice kernel from NAIF to find heliocentric</span>
<span class="sd">        equatorial position vectors (astropy Quantity in km) for solar system</span>
<span class="sd">        objects.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">            bodyname (string):</span>
<span class="sd">                Solar system object name</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_body (astropy Quantity nx3 array):</span>
<span class="sd">                Heliocentric equatorial position vector in units of km</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="c1"># dictionary of solar system bodies available in spice kernel</span>
        <span class="n">bodies</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Mercury&#39;</span><span class="p">:</span><span class="mi">199</span><span class="p">,</span>
                  <span class="s1">&#39;Venus&#39;</span><span class="p">:</span><span class="mi">299</span><span class="p">,</span>
                  <span class="s1">&#39;Earth&#39;</span><span class="p">:</span><span class="mi">399</span><span class="p">,</span>
                  <span class="s1">&#39;Mars&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                  <span class="s1">&#39;Jupiter&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
                  <span class="s1">&#39;Saturn&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
                  <span class="s1">&#39;Uranus&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span>
                  <span class="s1">&#39;Neptune&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                  <span class="s1">&#39;Pluto&#39;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span>
                  <span class="s1">&#39;Sun&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                  <span class="s1">&#39;Moon&#39;</span><span class="p">:</span><span class="mi">301</span><span class="p">}</span>
        
        <span class="k">assert</span> <span class="n">bodies</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">bodyname</span><span class="p">),</span>\
                 <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a recognized body name.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">bodyname</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">bodies</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]</span> <span class="o">==</span> <span class="mi">199</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">199</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        <span class="k">elif</span> <span class="n">bodies</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]</span> <span class="o">==</span> <span class="mi">299</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">299</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        <span class="k">elif</span> <span class="n">bodies</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]</span> <span class="o">==</span> <span class="mi">399</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">399</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        <span class="k">elif</span> <span class="n">bodies</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]</span> <span class="o">==</span> <span class="mi">301</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">+</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">301</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">r_body</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">bodies</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span> <span class="o">-</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        
        <span class="k">return</span> <span class="n">r_body</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.keplerplanet"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.keplerplanet">[docs]</a>    <span class="k">def</span> <span class="nf">keplerplanet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">,</span> <span class="n">bodyname</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds position vector for solar system objects</span>
<span class="sd">        </span>
<span class="sd">        This method uses algorithms 2 and 10 from Vallado 2013 to find </span>
<span class="sd">        heliocentric equatorial position vectors (astropy Quantity in km) for </span>
<span class="sd">        solar system objects.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">            bodyname (string):</span>
<span class="sd">                Solar system object name</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_body (astropy Quantity nx3 array):</span>
<span class="sd">                Heliocentric equatorial position vector in units of km</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">bodyname</span> <span class="o">==</span> <span class="s1">&#39;Moon&#39;</span><span class="p">:</span>
            <span class="n">r_Earth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keplerplanet</span><span class="p">(</span><span class="n">currentTime</span><span class="p">,</span> <span class="s1">&#39;Earth&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">r_Earth</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">moon_earth</span><span class="p">(</span><span class="n">currentTime</span><span class="p">)</span>
        
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">planets</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">bodyname</span><span class="p">),</span>\
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a recognized body name.&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">bodyname</span><span class="p">)</span>
        
        <span class="n">planet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">planets</span><span class="p">[</span><span class="n">bodyname</span><span class="p">]</span> 
        <span class="c1"># find Julian centuries from J2000</span>
        <span class="n">TDB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cent</span><span class="p">(</span><span class="n">currentTime</span><span class="p">)</span>
        <span class="c1"># update ephemeride data</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="n">TDB</span><span class="p">)</span>
        <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">e</span><span class="p">,</span> <span class="n">TDB</span><span class="p">)</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">I</span><span class="p">,</span> <span class="n">TDB</span><span class="p">))</span>
        <span class="n">O</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">O</span><span class="p">,</span> <span class="n">TDB</span><span class="p">))</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">TDB</span><span class="p">))</span>
        <span class="n">lM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">propeph</span><span class="p">(</span><span class="n">planet</span><span class="o">.</span><span class="n">lM</span><span class="p">,</span> <span class="n">TDB</span><span class="p">))</span>
        <span class="c1"># Find mean anomaly and argument of perigee</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">lM</span> <span class="o">-</span> <span class="n">w</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">wp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">O</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="c1"># Find eccentric anomaly</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">eccanom</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">e</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Find true anomaly</span>
        <span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span>
        <span class="c1"># Find semiparameter</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1"># position vector (km) in orbital plane</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">nu</span><span class="p">))</span>
        <span class="n">ry</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">e</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">nu</span><span class="p">))</span>
        <span class="n">rz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="n">r_body</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">rx</span><span class="p">,</span><span class="n">ry</span><span class="p">,</span><span class="n">rz</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="c1"># position vector (km) in ecliptic plane</span>
        <span class="n">r_body</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="o">-</span><span class="n">O</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="o">-</span><span class="n">I</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="mi">1</span><span class="p">)),</span>\
                <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="o">-</span><span class="n">wp</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span><span class="n">r_body</span><span class="p">[</span><span class="n">x</span><span class="p">,:]))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span>
        <span class="c1"># find obliquity of the ecliptic</span>
        <span class="n">obe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obe</span><span class="p">(</span><span class="n">TDB</span><span class="p">))</span>
        <span class="c1"># position vector (km) in heliocentric equatorial frame</span>
        <span class="n">r_body</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rot</span><span class="p">(</span><span class="o">-</span><span class="n">obe</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="mi">1</span><span class="p">),</span><span class="n">r_body</span><span class="p">[</span><span class="n">x</span><span class="p">,:])</span>\
                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)])</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        
        <span class="k">return</span> <span class="n">r_body</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.moon_earth"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.moon_earth">[docs]</a>    <span class="k">def</span> <span class="nf">moon_earth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds geocentric equatorial position vector (km) for Earth&#39;s moon</span>
<span class="sd">        </span>
<span class="sd">        This method uses Algorithm 31 from Vallado 2013 to find the geocentric</span>
<span class="sd">        equatorial position vector for Earth&#39;s moon.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_moon (astropy Quantity nx3 array):</span>
<span class="sd">                Geocentric equatorial position vector in units of km</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="n">TDB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cent</span><span class="p">(</span><span class="n">currentTime</span><span class="p">)</span>
        <span class="n">la</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">218.32</span> <span class="o">+</span> <span class="mf">481267.8813</span><span class="o">*</span><span class="n">TDB</span> <span class="o">+</span> \
            <span class="mf">6.29</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">134.9</span> <span class="o">+</span> <span class="mf">477198.85</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">-</span> 
            <span class="mf">1.27</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">259.2</span> <span class="o">-</span> <span class="mf">413335.38</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.66</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">235.7</span> <span class="o">+</span> <span class="mf">890534.23</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.21</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">269.9</span> <span class="o">+</span> <span class="mf">954397.70</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">-</span> 
            <span class="mf">0.19</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">357.5</span> <span class="o">+</span> <span class="mf">35999.05</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">-</span> 
            <span class="mf">0.11</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">186.6</span> <span class="o">+</span> <span class="mf">966404.05</span><span class="o">*</span><span class="n">TDB</span><span class="p">)))</span>
        
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">5.13</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">93.3</span> <span class="o">+</span> <span class="mf">483202.03</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.28</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">228.2</span> <span class="o">+</span> <span class="mf">960400.87</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">-</span> 
            <span class="mf">0.28</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">318.3</span> <span class="o">+</span> <span class="mf">6003.18</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">-</span> 
            <span class="mf">0.17</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">217.6</span> <span class="o">-</span> <span class="mf">407332.20</span><span class="o">*</span><span class="n">TDB</span><span class="p">)))</span>
        
        <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">0.9508</span> <span class="o">+</span> <span class="mf">0.0518</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">134.9</span> <span class="o">+</span> <span class="mf">477198.85</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.0095</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">259.2</span> <span class="o">-</span> <span class="mf">413335.38</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.0078</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">235.7</span> <span class="o">+</span> <span class="mf">890534.23</span><span class="o">*</span><span class="n">TDB</span><span class="p">))</span> <span class="o">+</span> 
            <span class="mf">0.0028</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">269.9</span> <span class="o">+</span> <span class="mf">954397.70</span><span class="o">*</span><span class="n">TDB</span><span class="p">)))</span>
        
        <span class="n">e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">23.439291</span> <span class="o">-</span> <span class="mf">0.0130042</span><span class="o">*</span><span class="n">TDB</span> <span class="o">-</span> <span class="mf">1.64e-7</span><span class="o">*</span><span class="n">TDB</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">5.04e-7</span><span class="o">*</span><span class="n">TDB</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="mf">6378.137</span> <span class="c1"># km</span>
        
        <span class="n">r_moon</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">la</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">la</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">la</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)])</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span>
        
        <span class="k">return</span> <span class="n">r_moon</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.starprop"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.starprop">[docs]</a>    <span class="k">def</span> <span class="nf">starprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TL</span><span class="p">,</span> <span class="n">sInds</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds target star position vector (km) for current time (MJD)</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            TL (TargetList module):</span>
<span class="sd">                TargetList class object</span>
<span class="sd">            sInds (integer ndarray):</span>
<span class="sd">                Integer indices of the stars of interest</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            r_star (astropy Quantity nx3 array): </span>
<span class="sd">                Position vectors of stars of interest in heliocentric </span>
<span class="sd">                equatorial frame in units of km</span>
<span class="sd">        </span>
<span class="sd">        Note: For multiple targets, currentTime must be of size 1 or size of sInds.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape sInds</span>
        <span class="n">sInds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sInds</span><span class="p">,</span><span class="n">ndmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        <span class="c1"># check size of sInds</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sInds</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">sInds</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> \
                    <span class="s1">&#39;For multiple targets, currentTime must be of size 1 or size of sInds&#39;</span>
        
        <span class="c1"># right ascension and declination</span>
        <span class="n">ra</span> <span class="o">=</span> <span class="n">TL</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">ra</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="n">TL</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">dec</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span>
        
        <span class="c1"># set J2000 epoch</span>
        <span class="n">j2000</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mf">2000.</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jyear&#39;</span><span class="p">)</span>
        
        <span class="c1"># directions</span>
        <span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ra</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ra</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sInds</span><span class="p">))])</span>
        <span class="n">q0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ra</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ra</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">dec</span><span class="p">)])</span>
        <span class="n">r0</span> <span class="o">=</span> <span class="p">(</span><span class="n">TL</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">xyz</span><span class="o">/</span><span class="n">TL</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span><span class="o">.</span><span class="n">distance</span><span class="p">)</span>
        
        <span class="c1"># proper motion vector</span>
        <span class="n">mu0</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">TL</span><span class="o">.</span><span class="n">pmra</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span> <span class="o">+</span> <span class="n">q0</span><span class="o">*</span><span class="n">TL</span><span class="o">.</span><span class="n">pmdec</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span>
        
        <span class="c1"># space velocity vector</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">mu0</span><span class="o">/</span><span class="n">TL</span><span class="o">.</span><span class="n">parx</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AU</span> <span class="o">+</span> <span class="n">r0</span><span class="o">*</span><span class="n">TL</span><span class="o">.</span><span class="n">rv</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span>
        
        <span class="c1"># stellar position vector</span>
        <span class="n">r_star</span> <span class="o">=</span> <span class="n">TL</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">sInds</span><span class="p">]</span><span class="o">.</span><span class="n">cartesian</span><span class="o">.</span><span class="n">xyz</span> <span class="o">+</span> <span class="n">v</span><span class="o">*</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">mjd</span> <span class="o">-</span> <span class="n">j2000</span><span class="o">.</span><span class="n">mjd</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">day</span>
        
        <span class="k">return</span> <span class="n">r_star</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span></div>

<div class="viewcode-block" id="Observatory.cent"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.cent">[docs]</a>    <span class="k">def</span> <span class="nf">cent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds time in Julian centuries since J2000 epoch</span>
<span class="sd">        </span>
<span class="sd">        This quantity is needed for many algorithms from Vallado 2013.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            TDB (float ndarray):</span>
<span class="sd">                time in Julian centuries since the J2000 epoch </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># reshape currentTime</span>
        <span class="n">currentTime</span> <span class="o">=</span> <span class="n">currentTime</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
        
        <span class="n">j2000</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="mf">2000.</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;jyear&#39;</span><span class="p">)</span>
        <span class="n">TDB</span> <span class="o">=</span> <span class="p">(</span><span class="n">currentTime</span><span class="o">.</span><span class="n">jd</span> <span class="o">-</span> <span class="n">j2000</span><span class="o">.</span><span class="n">jd</span><span class="p">)</span><span class="o">/</span><span class="mf">36525.</span>
        
        <span class="k">return</span> <span class="n">TDB</span></div>

<div class="viewcode-block" id="Observatory.propeph"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.propeph">[docs]</a>    <span class="k">def</span> <span class="nf">propeph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">TDB</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Propagates ephemeride to current time and returns this value</span>
<span class="sd">        </span>
<span class="sd">        This method propagates the ephemerides from Vallado 2013 to the current</span>
<span class="sd">        time.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            x (list):</span>
<span class="sd">                ephemeride list (maximum of 4 elements)</span>
<span class="sd">            TDB (float):</span>
<span class="sd">                time in Julian centuries since the J2000 epoch</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            y (float ndarray):</span>
<span class="sd">                ephemeride value at current time</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">q</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">q</span><span class="p">:</span>
                    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">TDB</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">TDB</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">y</span></div>

<div class="viewcode-block" id="Observatory.rot"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.rot">[docs]</a>    <span class="k">def</span> <span class="nf">rot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">th</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds the rotation matrix of angle th about the axis value</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            th (float):</span>
<span class="sd">                Rotation angle in radians</span>
<span class="sd">            axis (int): </span>
<span class="sd">                Integer value denoting rotation axis (1,2, or 3)</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            rot_th (float 3x3 ndarray):</span>
<span class="sd">                Rotation matrix</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rot_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> 
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)],</span> 
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rot_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)],</span>
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]])</span>
        <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">rot_th</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="mf">0.</span><span class="p">],</span>
                    <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
        
        <span class="k">return</span> <span class="n">rot_th</span></div>

<div class="viewcode-block" id="Observatory.distForces"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.distForces">[docs]</a>    <span class="k">def</span> <span class="nf">distForces</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TL</span><span class="p">,</span> <span class="n">sInd</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Finds lateral and axial disturbance forces on an occulter </span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            TL (TargetList module):</span>
<span class="sd">                TargetList class object</span>
<span class="sd">            sInd (integer ndarray):</span>
<span class="sd">                Integer indices of the star of interest</span>
<span class="sd">            currentTime (astropy Time):</span>
<span class="sd">                Current absolute mission time in MJD</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            dF_lateral (astropy Quantity):</span>
<span class="sd">                Lateral disturbance force in units of N</span>
<span class="sd">            dF_axial (astropy Quantity):</span>
<span class="sd">                Axial disturbance force in units of N</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># occulter separation distance</span>
        <span class="n">occulterSep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">occulterSep</span>
        
        <span class="c1"># get spacecraft position vector</span>
        <span class="n">r_Ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orbit</span><span class="p">(</span><span class="n">currentTime</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># sun -&gt; earth position vector</span>
        <span class="n">r_Es</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solarSystem_body_position</span><span class="p">(</span><span class="n">currentTime</span><span class="p">,</span> <span class="s1">&#39;Earth&#39;</span><span class="p">)</span>
        <span class="c1"># sun -&gt; target star vector</span>
        <span class="n">r_ts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">starprop</span><span class="p">(</span><span class="n">TL</span><span class="p">,</span> <span class="n">sInd</span><span class="p">,</span> <span class="n">currentTime</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Telescope -&gt; target vector and unit vector</span>
        <span class="n">r_tT</span> <span class="o">=</span> <span class="n">r_ts</span> <span class="o">-</span> <span class="n">r_Ts</span>
        <span class="n">u_tT</span> <span class="o">=</span> <span class="n">r_tT</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_tT</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1"># sun -&gt; occulter vector</span>
        <span class="n">r_Os</span> <span class="o">=</span> <span class="n">r_Ts</span> <span class="o">+</span> <span class="n">occulterSep</span><span class="o">*</span><span class="n">u_tT</span>
        <span class="c1"># Earth-Moon barycenter -&gt; spacecraft vectors</span>
        <span class="n">r_TE</span> <span class="o">=</span> <span class="n">r_Ts</span> <span class="o">-</span> <span class="n">r_Es</span>
        <span class="n">r_OE</span> <span class="o">=</span> <span class="n">r_Os</span> <span class="o">-</span> <span class="n">r_Es</span>
        
        <span class="c1"># force on occulter</span>
        <span class="n">F_sO</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">scMass</span><span class="o">*</span><span class="n">r_Os</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_Os</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="n">mEMB</span> <span class="o">=</span> <span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="o">/</span><span class="mf">328900.56</span>
        <span class="n">F_EO</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">*</span><span class="n">mEMB</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">scMass</span><span class="o">*</span><span class="n">r_OE</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_OE</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="n">F_O</span> <span class="o">=</span> <span class="n">F_sO</span> <span class="o">+</span> <span class="n">F_EO</span>
        
        <span class="c1"># force on telescope</span>
        <span class="n">F_sT</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coMass</span><span class="o">*</span><span class="n">r_Ts</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_Ts</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="n">F_ET</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">const</span><span class="o">.</span><span class="n">G</span><span class="o">*</span><span class="n">mEMB</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">coMass</span><span class="o">*</span><span class="n">r_TE</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_TE</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="n">F_T</span> <span class="o">=</span> <span class="n">F_sT</span> <span class="o">+</span> <span class="n">F_ET</span>
        
        <span class="c1"># differential forces</span>
        <span class="n">dF</span> <span class="o">=</span> <span class="p">((</span><span class="n">F_O</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">scMass</span> <span class="o">-</span> <span class="n">F_T</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">coMass</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">scMass</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span>
        <span class="n">dF_axial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dF</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">),</span> <span class="n">u_tT</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">N</span>
        <span class="n">dF_lateral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">dF</span> <span class="o">-</span> <span class="n">dF_axial</span><span class="o">*</span><span class="n">u_tT</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">dF_axial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dF_axial</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">dF_lateral</span><span class="p">,</span> <span class="n">dF_axial</span></div>

<div class="viewcode-block" id="Observatory.mass_dec"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.mass_dec">[docs]</a>    <span class="k">def</span> <span class="nf">mass_dec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dF_lateral</span><span class="p">,</span> <span class="n">t_int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns mass_used and deltaV </span>
<span class="sd">        </span>
<span class="sd">        The values returned by this method are used to decrement spacecraft </span>
<span class="sd">        mass for station-keeping.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            dF_lateral (astropy Quantity):</span>
<span class="sd">                Lateral disturbance force in units of N</span>
<span class="sd">            t_int (astropy Quantity):</span>
<span class="sd">                Integration time in units of day</span>
<span class="sd">                </span>
<span class="sd">        Returns:</span>
<span class="sd">            intMdot (astropy Quantity):</span>
<span class="sd">                Mass flow rate in units of kg/s</span>
<span class="sd">            mass_used (astropy Quantity):</span>
<span class="sd">                Mass used in station-keeping units of kg</span>
<span class="sd">            deltaV (astropy Quantity):</span>
<span class="sd">                Change in velocity required for station-keeping in units of km/s</span>
<span class="sd">                </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">intMdot</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">45.</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mf">5.</span><span class="p">))</span><span class="o">*</span><span class="n">dF_lateral</span><span class="o">/</span><span class="n">const</span><span class="o">.</span><span class="n">g0</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">skIsp</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kg/s&#39;</span><span class="p">)</span>
        <span class="n">mass_used</span> <span class="o">=</span> <span class="p">(</span><span class="n">intMdot</span><span class="o">*</span><span class="n">t_int</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;kg&#39;</span><span class="p">)</span>
        <span class="n">deltaV</span> <span class="o">=</span> <span class="p">(</span><span class="n">dF_lateral</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">scMass</span><span class="o">*</span><span class="n">t_int</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km/s&#39;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">intMdot</span><span class="p">,</span> <span class="n">mass_used</span><span class="p">,</span> <span class="n">deltaV</span></div>

<div class="viewcode-block" id="Observatory.SolarEph"><a class="viewcode-back" href="../../../EXOSIMS.Prototypes.html#EXOSIMS.Prototypes.Observatory.Observatory.SolarEph">[docs]</a>    <span class="k">class</span> <span class="nc">SolarEph</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Solar system ephemerides class </span>
<span class="sd">        </span>
<span class="sd">        This class takes the constants in Appendix D.4 of Vallado as inputs</span>
<span class="sd">        and stores them for use in defining solar system ephemerides at a </span>
<span class="sd">        given time.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            a (list):</span>
<span class="sd">                semimajor axis list (in AU)</span>
<span class="sd">            e (list):</span>
<span class="sd">                eccentricity list</span>
<span class="sd">            I (list):</span>
<span class="sd">                inclination list</span>
<span class="sd">            O (list):</span>
<span class="sd">                right ascension of the ascending node list</span>
<span class="sd">            w (list):</span>
<span class="sd">                longitude of periapsis list</span>
<span class="sd">            lM (list):</span>
<span class="sd">                mean longitude list</span>
<span class="sd">                </span>
<span class="sd">        Each of these lists has a maximum of 4 elements. The values in </span>
<span class="sd">        these lists are used to propagate the solar system planetary </span>
<span class="sd">        ephemerides for a specific solar system planet.</span>
<span class="sd">        </span>
<span class="sd">        Attributes:</span>
<span class="sd">            a (list):</span>
<span class="sd">                list of semimajor axis (in AU)</span>
<span class="sd">            e (list):</span>
<span class="sd">                list of eccentricity</span>
<span class="sd">            I (list):</span>
<span class="sd">                list of inclination</span>
<span class="sd">            O (list):</span>
<span class="sd">                list of right ascension of the ascending node</span>
<span class="sd">            w (list):</span>
<span class="sd">                list of longitude of periapsis</span>
<span class="sd">            lM (list):</span>
<span class="sd">                list of mean longitude values</span>
<span class="sd">            </span>
<span class="sd">        Each of these lists has a maximum of 4 elements. The values in </span>
<span class="sd">        these lists are used to propagate the solar system planetary </span>
<span class="sd">        ephemerides for a specific solar system planet.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">lM</span><span class="p">):</span>
            
            <span class="c1"># store list of semimajor axis values (convert from AU to km)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">AU</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="c1"># store list of dimensionless eccentricity values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">e</span> <span class="o">=</span> <span class="n">e</span>
            <span class="c1"># store list of inclination values (degrees)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="n">I</span>
            <span class="c1"># store list of right ascension of ascending node values (degrees)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">O</span> <span class="o">=</span> <span class="n">O</span> 
            <span class="c1"># store list of longitude of periapsis values (degrees)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">w</span> 
            <span class="c1"># store list of mean longitude values (degrees)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lM</span> <span class="o">=</span> <span class="n">lM</span>

        <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;String representation of the SolarEph object</span>
<span class="sd">            </span>
<span class="sd">            When the command &#39;print&#39; is used on the SolarEph object, this </span>
<span class="sd">            method will print the attribute values contained in the object&quot;&quot;&quot;</span>
            
            <span class="k">for</span> <span class="n">att</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">att</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">att</span><span class="p">))</span>
            
            <span class="k">return</span> <span class="s1">&#39;SolarEph class object attributes&#39;</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015 - 2017, SIOSlab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
    </div>

    

    
  </body>
</html>